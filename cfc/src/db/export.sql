--------------------------------------------------------
--  File created - Thursday-June-23-2016   
--------------------------------------------------------
--------------------------------------------------------
--  DDL for Sequence DEMO_CUST_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "CFCUSER"."DEMO_CUST_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 21 CACHE 20 NOORDER  NOCYCLE ;
--------------------------------------------------------
--  DDL for Sequence DEMO_ORDER_ITEMS_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "CFCUSER"."DEMO_ORDER_ITEMS_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 61 CACHE 20 NOORDER  NOCYCLE ;
--------------------------------------------------------
--  DDL for Sequence DEMO_ORD_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "CFCUSER"."DEMO_ORD_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 11 CACHE 20 NOORDER  NOCYCLE ;
--------------------------------------------------------
--  DDL for Sequence DEMO_PROD_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "CFCUSER"."DEMO_PROD_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 21 CACHE 20 NOORDER  NOCYCLE ;
--------------------------------------------------------
--  DDL for Sequence DEMO_USERS_SEQ
--------------------------------------------------------

   CREATE SEQUENCE  "CFCUSER"."DEMO_USERS_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 21 CACHE 20 NOORDER  NOCYCLE ;
--------------------------------------------------------
--  DDL for Sequence SEQ_STUDENT
--------------------------------------------------------

   CREATE SEQUENCE  "CFCUSER"."SEQ_STUDENT"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 11 CACHE 10 NOORDER  NOCYCLE ;
--------------------------------------------------------
--  DDL for Table HISTORICOS
--------------------------------------------------------

  CREATE TABLE "CFCUSER"."HISTORICOS" 
   (	"CODIGO_EMPRESA" NUMBER, 
	"FECHA_VALIDA" TIMESTAMP (6), 
	"CODIGO_REGION" VARCHAR2(20 BYTE), 
	"NOM_REGION" VARCHAR2(50 BYTE), 
	"CODIGO_AGENCIA" NUMBER, 
	"NOM_AGENCIA" VARCHAR2(50 BYTE), 
	"CODIGO_USUARIO" NUMBER, 
	"NOM_USUARIO" VARCHAR2(50 BYTE), 
	"HORA_MOVIMIENTO" TIMESTAMP (6), 
	"CODIGO_TIPO_TRANSACCION" NUMBER, 
	"CODIGO_MONEDA" VARCHAR2(20 BYTE), 
	"ENTRADA_SALIDA" VARCHAR2(20 BYTE), 
	"CLIENTE_EMPRESA" VARCHAR2(20 BYTE), 
	"DESC_TRANSACCION" VARCHAR2(50 BYTE), 
	"MONTO_VALOR" NUMBER, 
	"ID_HISTORICO" NUMBER
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table MONEDA
--------------------------------------------------------

  CREATE TABLE "CFCUSER"."MONEDA" 
   (	"ID" NUMBER, 
	"DESCRIPCION" VARCHAR2(20 BYTE), 
	"SIMBOLO" CHAR(1 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table MOVIMIENTOS
--------------------------------------------------------

  CREATE TABLE "CFCUSER"."MOVIMIENTOS" 
   (	"CODIGO_EMPRESA" NUMBER, 
	"FECHA_VALIDA" TIMESTAMP (6), 
	"CODIGO_REGION" VARCHAR2(20 BYTE), 
	"NOM_REGION" VARCHAR2(50 BYTE), 
	"CODIGO_AGENCIA" NUMBER, 
	"NOM_AGENCIA" VARCHAR2(50 BYTE), 
	"CODIGO_USUARIO" NUMBER, 
	"NOM_USUARIO" VARCHAR2(50 BYTE), 
	"HORA_MOVIMIENTO" TIMESTAMP (6), 
	"CODIGO_TIPO_TRANSACCION" NUMBER, 
	"CODIGO_MONEDA" VARCHAR2(20 BYTE), 
	"ENTRADA_SALIDA" VARCHAR2(20 BYTE), 
	"CLIENTE_EMPRESA" VARCHAR2(20 BYTE), 
	"DESC_TRANSACCION" VARCHAR2(50 BYTE), 
	"MONTO_VALOR" NUMBER, 
	"ID_MOVIMIENTO" NUMBER
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table PIVOT
--------------------------------------------------------

  CREATE TABLE "CFCUSER"."PIVOT" 
   (	"ID" NUMBER, 
	"FECHA" TIMESTAMP (6), 
	"COD_AGENCIA" NUMBER, 
	"COD_MONEDA" NUMBER, 
	"SALDO" NUMBER, 
	"LCSX" NUMBER, 
	"LCX" NUMBER, 
	"LCIX" NUMBER, 
	"RM" NUMBER, 
	"LCSR" NUMBER, 
	"LCR" NUMBER, 
	"LCIR" NUMBER, 
	"SEGURO_MAX" NUMBER, 
	"PUNTO_REORDEN" NUMBER, 
	"OCIOSO" NUMBER, 
	"RESERVA" NUMBER, 
	"MENUDO" NUMBER, 
	"SALDO_AUTORIZADO" NUMBER, 
	"UTILIZACION" NUMBER
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table SALDOS
--------------------------------------------------------

  CREATE TABLE "CFCUSER"."SALDOS" 
   (	"CODIGO_USUARIO" VARCHAR2(20 BYTE), 
	"NOM_USUARIO" VARCHAR2(50 BYTE), 
	"CODIGO_AGENCIA" NUMBER, 
	"NOM_AGENCIA" VARCHAR2(20 BYTE), 
	"CODIGO_MONEDA" VARCHAR2(20 BYTE), 
	"FECHA" TIMESTAMP (6), 
	"ID_SALDO" NUMBER, 
	"MONTO" NUMBER
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table SUCURSALES
--------------------------------------------------------

  CREATE TABLE "CFCUSER"."SUCURSALES" 
   (	"CODIGO_AGENCIA" NUMBER, 
	"NOM_AGENCIA" VARCHAR2(50 BYTE), 
	"MONTO_ASEGURADO" NUMBER, 
	"MONTO_AUTORIZADO" NUMBER, 
	"HORA_APERTURA" TIMESTAMP (6), 
	"HORA_CIERRE" TIMESTAMP (6), 
	"ID_SUCURSAL" NUMBER
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Table USERS
--------------------------------------------------------

  CREATE TABLE "CFCUSER"."USERS" 
   (	"USERNAME" VARCHAR2(36 BYTE), 
	"PASSWORD" VARCHAR2(36 BYTE), 
	"ROLE" VARCHAR2(36 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
REM INSERTING into CFCUSER.HISTORICOS
SET DEFINE OFF;
Insert into CFCUSER.HISTORICOS (CODIGO_EMPRESA,FECHA_VALIDA,CODIGO_REGION,NOM_REGION,CODIGO_AGENCIA,NOM_AGENCIA,CODIGO_USUARIO,NOM_USUARIO,HORA_MOVIMIENTO,CODIGO_TIPO_TRANSACCION,CODIGO_MONEDA,ENTRADA_SALIDA,CLIENTE_EMPRESA,DESC_TRANSACCION,MONTO_VALOR,ID_HISTORICO) values (1,to_timestamp('16-MAR-16 02.28.29.501000000 AM','DD-MON-RR HH.MI.SSXFF AM'),'01','SAN JOSE',3,'CENTRAL',2,'MARIA',to_timestamp('15-MAR-16 02.29.13.643000000 AM','DD-MON-RR HH.MI.SSXFF AM'),null,'DOLARES','E','C','EFECTIVO SALIDA
',545322.2,2);
Insert into CFCUSER.HISTORICOS (CODIGO_EMPRESA,FECHA_VALIDA,CODIGO_REGION,NOM_REGION,CODIGO_AGENCIA,NOM_AGENCIA,CODIGO_USUARIO,NOM_USUARIO,HORA_MOVIMIENTO,CODIGO_TIPO_TRANSACCION,CODIGO_MONEDA,ENTRADA_SALIDA,CLIENTE_EMPRESA,DESC_TRANSACCION,MONTO_VALOR,ID_HISTORICO) values (1,to_timestamp('16-MAR-16 02.20.21.515000000 AM','DD-MON-RR HH.MI.SSXFF AM'),'06','PUNTARENAS',4,'PUNTARENAS',1,'JUAN',to_timestamp('16-MAR-16 02.20.28.970000000 AM','DD-MON-RR HH.MI.SSXFF AM'),1,'COLONES','E','C','DEPOSITO EN EFECTIVO',20000,1);
REM INSERTING into CFCUSER.MONEDA
SET DEFINE OFF;
REM INSERTING into CFCUSER.MOVIMIENTOS
SET DEFINE OFF;
Insert into CFCUSER.MOVIMIENTOS (CODIGO_EMPRESA,FECHA_VALIDA,CODIGO_REGION,NOM_REGION,CODIGO_AGENCIA,NOM_AGENCIA,CODIGO_USUARIO,NOM_USUARIO,HORA_MOVIMIENTO,CODIGO_TIPO_TRANSACCION,CODIGO_MONEDA,ENTRADA_SALIDA,CLIENTE_EMPRESA,DESC_TRANSACCION,MONTO_VALOR,ID_MOVIMIENTO) values (1,null,'01','SAN JOSE',4,'PUNTARENAS',1,'JUAN',null,null,'COLONES','E',null,null,200000,22);
Insert into CFCUSER.MOVIMIENTOS (CODIGO_EMPRESA,FECHA_VALIDA,CODIGO_REGION,NOM_REGION,CODIGO_AGENCIA,NOM_AGENCIA,CODIGO_USUARIO,NOM_USUARIO,HORA_MOVIMIENTO,CODIGO_TIPO_TRANSACCION,CODIGO_MONEDA,ENTRADA_SALIDA,CLIENTE_EMPRESA,DESC_TRANSACCION,MONTO_VALOR,ID_MOVIMIENTO) values (2,null,'06','PUNTARENAS',3,'CENTRAL',2,'MARIA',null,null,'COLONES','E',null,null,454545,33);
Insert into CFCUSER.MOVIMIENTOS (CODIGO_EMPRESA,FECHA_VALIDA,CODIGO_REGION,NOM_REGION,CODIGO_AGENCIA,NOM_AGENCIA,CODIGO_USUARIO,NOM_USUARIO,HORA_MOVIMIENTO,CODIGO_TIPO_TRANSACCION,CODIGO_MONEDA,ENTRADA_SALIDA,CLIENTE_EMPRESA,DESC_TRANSACCION,MONTO_VALOR,ID_MOVIMIENTO) values (3,null,'05','GUANACASTE',3,'LIBERIA',3,'CARLOS',null,null,'COLONES','S',null,null,4545454,44);
REM INSERTING into CFCUSER.PIVOT
SET DEFINE OFF;
REM INSERTING into CFCUSER.SALDOS
SET DEFINE OFF;
Insert into CFCUSER.SALDOS (CODIGO_USUARIO,NOM_USUARIO,CODIGO_AGENCIA,NOM_AGENCIA,CODIGO_MONEDA,FECHA,ID_SALDO,MONTO) values ('1','JUAN',4,'PUNTARENAS','COLONES',to_timestamp('07-APR-16 04.10.22.209000000 AM','DD-MON-RR HH.MI.SSXFF AM'),200,null);
Insert into CFCUSER.SALDOS (CODIGO_USUARIO,NOM_USUARIO,CODIGO_AGENCIA,NOM_AGENCIA,CODIGO_MONEDA,FECHA,ID_SALDO,MONTO) values ('2','MARIA',3,'CENTRAL','DOLARES',to_timestamp('07-APR-16 04.10.18.575000000 AM','DD-MON-RR HH.MI.SSXFF AM'),3300,null);
Insert into CFCUSER.SALDOS (CODIGO_USUARIO,NOM_USUARIO,CODIGO_AGENCIA,NOM_AGENCIA,CODIGO_MONEDA,FECHA,ID_SALDO,MONTO) values ('3','CARLOS',5,'LIBERIA','COLONES',to_timestamp('07-APR-16 04.09.21.378000000 AM','DD-MON-RR HH.MI.SSXFF AM'),5850,null);
Insert into CFCUSER.SALDOS (CODIGO_USUARIO,NOM_USUARIO,CODIGO_AGENCIA,NOM_AGENCIA,CODIGO_MONEDA,FECHA,ID_SALDO,MONTO) values ('4','JORGE',1,'GUAPILES','COLONES',to_timestamp('07-APR-16 04.09.51.101000000 AM','DD-MON-RR HH.MI.SSXFF AM'),6500,null);
Insert into CFCUSER.SALDOS (CODIGO_USUARIO,NOM_USUARIO,CODIGO_AGENCIA,NOM_AGENCIA,CODIGO_MONEDA,FECHA,ID_SALDO,MONTO) values ('9','LUIS',4,'PUNTARENAS','COLONES',to_timestamp('07-APR-16 04.17.23.049000000 AM','DD-MON-RR HH.MI.SSXFF AM'),8000,null);
Insert into CFCUSER.SALDOS (CODIGO_USUARIO,NOM_USUARIO,CODIGO_AGENCIA,NOM_AGENCIA,CODIGO_MONEDA,FECHA,ID_SALDO,MONTO) values ('2','MARIA',3,'CENTRAL','DOLARES',to_timestamp('07-APR-16 04.17.53.854000000 AM','DD-MON-RR HH.MI.SSXFF AM'),800,null);
Insert into CFCUSER.SALDOS (CODIGO_USUARIO,NOM_USUARIO,CODIGO_AGENCIA,NOM_AGENCIA,CODIGO_MONEDA,FECHA,ID_SALDO,MONTO) values ('2','MARIA',3,'CENTRAL','DOLARES',to_timestamp('07-APR-16 04.18.13.871000000 AM','DD-MON-RR HH.MI.SSXFF AM'),500,null);
REM INSERTING into CFCUSER.SUCURSALES
SET DEFINE OFF;
Insert into CFCUSER.SUCURSALES (CODIGO_AGENCIA,NOM_AGENCIA,MONTO_ASEGURADO,MONTO_AUTORIZADO,HORA_APERTURA,HORA_CIERRE,ID_SUCURSAL) values (1,'CENTRAL',null,null,null,null,12);
Insert into CFCUSER.SUCURSALES (CODIGO_AGENCIA,NOM_AGENCIA,MONTO_ASEGURADO,MONTO_AUTORIZADO,HORA_APERTURA,HORA_CIERRE,ID_SUCURSAL) values (2,'LIMON',null,null,null,null,11);
Insert into CFCUSER.SUCURSALES (CODIGO_AGENCIA,NOM_AGENCIA,MONTO_ASEGURADO,MONTO_AUTORIZADO,HORA_APERTURA,HORA_CIERRE,ID_SUCURSAL) values (3,'GUAPILES',null,null,null,null,101);
Insert into CFCUSER.SUCURSALES (CODIGO_AGENCIA,NOM_AGENCIA,MONTO_ASEGURADO,MONTO_AUTORIZADO,HORA_APERTURA,HORA_CIERRE,ID_SUCURSAL) values (4,'PUNTARENAS',null,null,null,null,102);
Insert into CFCUSER.SUCURSALES (CODIGO_AGENCIA,NOM_AGENCIA,MONTO_ASEGURADO,MONTO_AUTORIZADO,HORA_APERTURA,HORA_CIERRE,ID_SUCURSAL) values (5,'LIBERIA',null,null,null,null,103);
REM INSERTING into CFCUSER.USERS
SET DEFINE OFF;
Insert into CFCUSER.USERS (USERNAME,PASSWORD,ROLE) values ('dbuser1','12345','ROLL_USER');
Insert into CFCUSER.USERS (USERNAME,PASSWORD,ROLE) values ('dbadmin1','1111','ROLL_ADMIN');
--------------------------------------------------------
--  DDL for Index PIVOT_PK
--------------------------------------------------------

  CREATE UNIQUE INDEX "CFCUSER"."PIVOT_PK" ON "CFCUSER"."PIVOT" ("ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index SALDOS_INDEX1
--------------------------------------------------------

  CREATE UNIQUE INDEX "CFCUSER"."SALDOS_INDEX1" ON "CFCUSER"."SALDOS" ("ID_SALDO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index SUCURSALES_PK
--------------------------------------------------------

  CREATE UNIQUE INDEX "CFCUSER"."SUCURSALES_PK" ON "CFCUSER"."SUCURSALES" ("ID_SUCURSAL") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index MONEDA_PK
--------------------------------------------------------

  CREATE UNIQUE INDEX "CFCUSER"."MONEDA_PK" ON "CFCUSER"."MONEDA" ("ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index HISTORICOS_INDEX1
--------------------------------------------------------

  CREATE UNIQUE INDEX "CFCUSER"."HISTORICOS_INDEX1" ON "CFCUSER"."HISTORICOS" ("ID_HISTORICO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Index MOVIMIENTOS_INDEX1
--------------------------------------------------------

  CREATE UNIQUE INDEX "CFCUSER"."MOVIMIENTOS_INDEX1" ON "CFCUSER"."MOVIMIENTOS" ("ID_MOVIMIENTO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  Constraints for Table MONEDA
--------------------------------------------------------

  ALTER TABLE "CFCUSER"."MONEDA" ADD CONSTRAINT "MONEDA_PK" PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
  ALTER TABLE "CFCUSER"."MONEDA" MODIFY ("ID" NOT NULL ENABLE);
--------------------------------------------------------
--  Constraints for Table USERS
--------------------------------------------------------

  ALTER TABLE "CFCUSER"."USERS" ADD PRIMARY KEY ("USERNAME")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
  ALTER TABLE "CFCUSER"."USERS" MODIFY ("ROLE" NOT NULL ENABLE);
  ALTER TABLE "CFCUSER"."USERS" MODIFY ("PASSWORD" NOT NULL ENABLE);
  ALTER TABLE "CFCUSER"."USERS" MODIFY ("USERNAME" NOT NULL ENABLE);
--------------------------------------------------------
--  Constraints for Table PIVOT
--------------------------------------------------------

  ALTER TABLE "CFCUSER"."PIVOT" ADD CONSTRAINT "PIVOT_PK" PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
  ALTER TABLE "CFCUSER"."PIVOT" MODIFY ("ID" NOT NULL ENABLE);
--------------------------------------------------------
--  Constraints for Table SALDOS
--------------------------------------------------------

  ALTER TABLE "CFCUSER"."SALDOS" MODIFY ("ID_SALDO" NOT NULL ENABLE);
  ALTER TABLE "CFCUSER"."SALDOS" ADD CONSTRAINT "SALDOS_PK" PRIMARY KEY ("ID_SALDO")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table SUCURSALES
--------------------------------------------------------

  ALTER TABLE "CFCUSER"."SUCURSALES" MODIFY ("ID_SUCURSAL" NOT NULL ENABLE);
  ALTER TABLE "CFCUSER"."SUCURSALES" ADD CONSTRAINT "SUCURSALES_PK" PRIMARY KEY ("ID_SUCURSAL")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table HISTORICOS
--------------------------------------------------------

  ALTER TABLE "CFCUSER"."HISTORICOS" MODIFY ("ID_HISTORICO" NOT NULL ENABLE);
  ALTER TABLE "CFCUSER"."HISTORICOS" ADD CONSTRAINT "HISTORICOS_PK" PRIMARY KEY ("ID_HISTORICO")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  Constraints for Table MOVIMIENTOS
--------------------------------------------------------

  ALTER TABLE "CFCUSER"."MOVIMIENTOS" MODIFY ("ID_MOVIMIENTO" NOT NULL ENABLE);
  ALTER TABLE "CFCUSER"."MOVIMIENTOS" ADD CONSTRAINT "MOVIMIENTOS_PK" PRIMARY KEY ("ID_MOVIMIENTO")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
--------------------------------------------------------
--  DDL for Function CUSTOM_AUTH
--------------------------------------------------------

  CREATE OR REPLACE FUNCTION "CFCUSER"."CUSTOM_AUTH" (p_username in VARCHAR2, p_password in VARCHAR2)
return BOOLEAN
is
  l_password varchar2(4000);
  l_stored_password varchar2(4000);
  l_expires_on date;
  l_count number;
begin
-- First, check to see if the user is in the user table
select count(*) into l_count from demo_users where user_name = p_username;
if l_count > 0 then
  -- First, we fetch the stored hashed password & expire date
  select password, expires_on into l_stored_password, l_expires_on
   from demo_users where user_name = p_username;

  -- Next, we check to see if the user's account is expired
  -- If it is, return FALSE
  if l_expires_on > sysdate or l_expires_on is null then

    -- If the account is not expired, we have to apply the custom hash
    -- function to the password
    l_password := custom_hash(p_username, p_password);

    -- Finally, we compare them to see if they are the same and return
    -- either TRUE or FALSE
    if l_password = l_stored_password then
      return true;
    else
      return false;
    end if;
  else
    return false;
  end if;
else
  -- The username provided is not in the DEMO_USERS table
  return false;
end if;
end;

/
--------------------------------------------------------
--  DDL for Function CUSTOM_HASH
--------------------------------------------------------

  CREATE OR REPLACE FUNCTION "CFCUSER"."CUSTOM_HASH" (p_username in varchar2, p_password in varchar2)
return varchar2
is
  l_password varchar2(4000);
  l_salt varchar2(4000) := 'LWVKBXHM81NHRWDVK57KJ5ITQ1PIVN';
begin

-- This function should be wrapped, as the hash algorhythm is exposed here.
-- You can change the value of l_salt or the method of which to call the
-- DBMS_OBFUSCATOIN toolkit, but you much reset all of your passwords
-- if you choose to do this.

l_password := utl_raw.cast_to_raw(dbms_obfuscation_toolkit.md5
  (input_string => p_password || substr(l_salt,10,13) || p_username ||
    substr(l_salt, 4,10)));
return l_password;
end;

/
--------------------------------------------------------
--  DDL for Function GETCANTIDADVALORES
--------------------------------------------------------

  CREATE OR REPLACE FUNCTION "CFCUSER"."GETCANTIDADVALORES" (codAgencia IN NUMBER,codMoneda IN VARCHAR2 ) 
   RETURN NUMBER as my_result NUMBER;
   BEGIN   
     SELECT SUM(MONTO_VALOR)  
     INTO my_result 
     FROM MOVIMIENTOS 
     WHERE CODIGO_MONEDA = codMoneda
     AND CODIGO_AGENCIA= codAgencia;
     RETURN my_result;
END;

/
--------------------------------------------------------
--  DDL for Function GETRMBARRA
--------------------------------------------------------

  CREATE OR REPLACE FUNCTION "CFCUSER"."GETRMBARRA" (codAgencia IN NUMBER,codMoneda IN VARCHAR2 ) 
   RETURN NUMBER as my_result NUMBER;
   BEGIN   
     SELECT SUM(MONTO_VALOR)  
     INTO my_result 
     FROM MOVIMIENTOS 
     WHERE CODIGO_MONEDA = codMoneda
     AND CODIGO_AGENCIA= codAgencia;
     RETURN my_result;
END;

/
--------------------------------------------------------
--  DDL for Package FORMULAS
--------------------------------------------------------

  CREATE OR REPLACE PACKAGE "CFCUSER"."FORMULAS" AS formulasCFC

  /* TODO enter package declarations (types, exceptions, methods etc) here */ 

END FORMULAS;

/
