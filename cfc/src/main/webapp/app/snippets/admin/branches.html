<div ng-controller="branchesController">
	<section class="content-header">
		<h1>Adminstraci&oacute;n de sucursales</h1>
	</section>
	<section class="content">
		<div class="container-fluid">
			<div class="row">
				<div class="col-md-12">

					<div class="box box-primary">
						<div class="box-body">
							<div class="table-responsive  animate-show" ng-hide="showForm">
								<table datatable="ng" class="table table-hover  row-border hover" >
									<thead>
										<tr>
											<th scope="row" class="text-center">Nombre sucursal</th>
											<th scope="row" class="text-center">Codigo sucursal</th>
											<th scope="row" class="text-center">Hora de apertura</th>
											<th scope="row" class="text-center">Hora de cierre</th>
											<th scope="row" class="text-center"><div class="btn-group" role="group" aria-label="...">
													<button type="button" class="btn btn-default" ng-click="addNew()">
														<span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
													</button>
												</div></th>
										</tr>
									</thead>
									<tbody>
										<tr ng-repeat-start="branch in branches">
											<td>{{ branch.nomSucursal}}</td>
											<td>{{ branch.codigoSucursal}}</td>
											<td>{{ branch.horaApertura | date: "HH:mm"}}</td>
											<td>{{ branch.horaCierre | date: "HH:mm"}}</td>
											<td>
												<div class="row">
													<div class="col-md-12">
														<div class="btn-group" role="group" aria-label="...">
															<button type="button" class="btn btn-default" ng-click="branch.expanded = !branch.expanded">
																<span class="glyphicon glyphicon-circle-arrow-down" aria-hidden="true"></span>
															</button>
															<button type="button" class="btn btn-default" ng-click="editBranch(branch)">
																<span class="glyphicon glyphicon-edit" aria-hidden="true"></span>
															</button>
															<button type="button" class="btn btn-default" ng-click="confirmDelete(branch)">
																<span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
															</button>
														</div>
													</div>
												</div>
											</td>
										</tr>
										<tr ng-repeat-end="">
											<td colspan="5" ng-if="branch.expanded">
												<table>
													<thead>
														<tr>
															<th scope="row" class="text-center">Moneda</th>
															<th scope="row" class="text-center">Monto asegurado</th>
															<th scope="row" class="text-center">Monto autorizado</th>
															<th scope="row" class="text-center">Porcentaje Menudo</th>
															<th scope="row" class="text-center">Porcentaje Reserva</th>
														</tr>
													</thead>
													<tbody>
														<tr ng-repeat="smm in branch.sucursalMontoMonedas">
															<td></td>
															<td>{{ smm.montoAsegurado | currency : smm.montoAsegurado.moneda.simbolo : 2 }}</td>
															<td>{{ smm.montoAutorizado | currency : smm.montoAutorizado.moneda.simbolo : 2 }}</td>
															<td>{{ branch.sucursalPorcents[$index].porcenMenudo }}</td>
															<td>{{ branch.sucursalPorcents[$index].porcenReserva}}</td>
														<tr>
													</tbody>
												</table>
											</td>
										</tr>
									</tbody>
								</table>
							</div>
							<div ng-show="showForm" class=" animate-show">
								<div class="form-group">
									<label for="nomAgencia" class="col-sm-4 control-label">Nombre</label>
									<div class="col-sm-8">
										<input type="text" ng-model="selectedBranch.nomSucursal" class="form-control" id="nomAgencia"
											placeholder="Nombre" />
									</div>
								</div>
								<div class="form-group">
									<label for="codAgencia" class="col-sm-4 control-label">C&oacute;digo</label>
									<div class="col-sm-8">
										<input type="number" ng-model="selectedBranch.codigoSucursal" class="form-control" id="codAgencia"
											placeholder="C&oacute;digo" />
									</div>
								</div>
								<div class="form-group">
									<label for="horaApertura" class="col-sm-4 control-label">Hora de apertura</label>
									<div class="col-sm-8">
										<input type="time" ng-model="selectedBranch.horaApertura" class="form-control" id="horaApertura"
											placeholder="Hora de apertura" bind-timestamp />
									</div>
								</div>
								<div class="form-group">
									<label for="horaCierre" class="col-sm-4 control-label">Hora de cierre</label>
									<div class="col-sm-8">
										<input type="time" ng-model="selectedBranch.horaCierre" class="form-control" id="horaCierre"
											placeholder="Hora de cierre"   bind-timestamp />
									</div>
								</div>

								<div class="panel panel-default">
									<div class="panel-body">
										<table style="margin: 20px;">
											<thead>
												<tr>
													<th scope="row" class="text-center">Moneda</th>
													<th scope="row" class="text-center">Monto asegurado</th>
													<th scope="row" class="text-center">Monto autorizado</th>
													<th scope="row" class="text-center">Porcentaje Menudo</th>
													<th scope="row" class="text-center">Porcentaje Reserva</th>
												</tr>
											</thead>
											<tbody>
												<tr ng-repeat="smm in selectedBranch.sucursalMontoMonedas">
													<td>{{smm.moneda.descripcion}}</td>
													<td>

														<div class="input-group">
															<span class="input-group-addon">{{smm.moneda.simbolo}}</span> <input type="number"
																ng-model="smm.montoAutorizado" class="form-control" id="horaCierre" placeholder="montoAutorizado" />
														</div>
													</td>
													<td>
														<div class="input-group" style="margin: 10px!important"> 
															<span class="input-group-addon">{{smm.moneda.simbolo}}</span> <input type="number"
																ng-model="smm.montoAsegurado" class="form-control" style=" text-align: right;" id="horaCierre" placeholder="montoAsegurado" />
														</div>
													</td>
													<td><div class="input-group">
															<input type="number" ng-model="selectedBranch.sucursalPorcents[$index].porcenMenudo" class="form-control"
																id="horaCierre" placeholder="porcenMenudo" /> <span class="input-group-addon">%</span>
														</div></td>
													<td><div class="input-group">
															<input type="number" ng-model="selectedBranch.sucursalPorcents[$index].porcenReserva"
																class="form-control" id="horaCierre" placeholder="porcenReserva" /><span class="input-group-addon">%</span>
														</div></td>
												<tr>
											</tbody>
										</table>
									</div>
								</div>

								<div class="col-sm-12">
									<button type="button" class="btn btn-default" ng-click="cancel()">
										<span class="glyphicon glyphicon-remove" aria-hidden="true"></span> <span>Cancel</span>
									</button>
									<button type="button" class="btn btn-default" ng-click="saveOrUpdate()">
										<span class="glyphicon glyphicon-edit" aria-hidden="true"></span> <span>Save</span>
									</button>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>
</div>